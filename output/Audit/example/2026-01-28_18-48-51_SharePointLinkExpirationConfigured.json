{
  "tenant": "example",
  "controlId": "SharePointLinkExpirationConfigured",
  "action": "ensure_applied",
  "displayName": "SharePoint: Anonymous link expiration configured (Secure Score)",
  "approved": true,
  "mode": "enforce",
  "state": "NOT_EVALUATED",
  "reasonCode": "MISSING_SIGNAL",
  "reasonDetail": "SPO bulk apply failed: Set-SPOTenant bulk update failed",
  "details": {
    "batch": {
      "adminUrl": "https://6twcdy-admin.sharepoint.com",
      "ok": false,
      "before": {
        "ok": true,
        "error": null,
        "tenant": {
          "AllowedDomainGuids": null,
          "IdleSessionSignOutAfterSeconds": 0,
          "SharingBlockedDomainList": null,
          "IdleSessionSignOutEnabled": false,
          "DefaultSharingLinkType": 2,
          "PreventExternalUsersFromResharing": true,
          "SharingDomainRestrictionMode": 1,
          "OneDriveSharingCapability": 2,
          "RequireAnonymousLinksExpireInDays": 30,
          "SyncClientRestrictionEnabled": null,
          "DefaultLinkPermission": 1,
          "LegacyAuthProtocolsEnabled": true,
          "SharingAllowedDomainList": "partner.com vendor.com",
          "IdleSessionSignOutWarnAfterSeconds": 0,
          "TenantSyncClientRestriction": {
            "AllowedDomainList": [],
            "GrooveBlockOption": null,
            "BlockMacSync": false,
            "TenantRestrictionEnabled": false
          },
          "SharingCapability": 2
        },
        "adminUrl": "https://6twcdy-admin.sharepoint.com",
        "exitCode": 0
      },
      "after": null,
      "desired": {
        "PreventExternalUsersFromResharing": true,
        "DefaultSharingLinkType": 2,
        "DefaultLinkPermission": 1,
        "RequireAnonymousLinksExpireInDays": 30,
        "SharingDomainRestrictionMode": "AllowList",
        "SharingAllowedDomainList": "partner.com vendor.com"
      },
      "applyResult": {
        "ok": false,
        "error": "Set-SPOTenant bulk update failed",
        "stdout": "WARNING: The names of some imported commands from the module 'Microsoft.Online.SharePoint.PowerShell' include \nunapproved verbs that might make them less discoverable. To find the commands with unapproved verbs, run the \nImport-Module command again with the Verbose parameter. For a list of approved verbs, type Get-Verb.",
        "stderr": "C:\\Users\\Alex\\Desktop\\Atlas\\engine\\detectors\\spo_set_tenant_settings_bulk.ps1 : The term 'else' is not recognized as \nthe name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was \nincluded, verify that the path is correct and try again.\n    + CategoryInfo          : ObjectNotFound: (else:String) [spo_set_tenant_settings_bulk.ps1], CommandNotFoundExcepti \n   on\n    + FullyQualifiedErrorId : CommandNotFoundException,spo_set_tenant_settings_bulk.ps1",
        "exitCode": 1,
        "cmd": [
          "powershell.exe",
          "-NoProfile",
          "-NonInteractive",
          "-NoLogo",
          "-ExecutionPolicy",
          "Bypass",
          "-File",
          "C:\\Users\\Alex\\Desktop\\Atlas\\engine\\detectors\\spo_set_tenant_settings_bulk.ps1",
          "-AdminUrl",
          "https://6twcdy-admin.sharepoint.com",
          "-SettingsJson",
          "{\"PreventExternalUsersFromResharing\": true, \"DefaultSharingLinkType\": 2, \"DefaultLinkPermission\": 1, \"RequireAnonymousLinksExpireInDays\": 30, \"SharingDomainRestrictionMode\": \"AllowList\", \"SharingAllowedDomainList\": \"partner.com vendor.com\"}",
          "-ClientId",
          "0c35c4bb-c4c1-4b68-9e86-7a17495391e2",
          "-TenantId",
          "d9ff2399-92ca-4e0c-87d0-5769459f2755",
          "-CertificateThumbprint",
          "78DE0CC5BDC285D499AFEC9D29EE1EEAEB9B8A5D"
        ],
        "adminUrl": "https://6twcdy-admin.sharepoint.com",
        "settings": {
          "PreventExternalUsersFromResharing": true,
          "DefaultSharingLinkType": 2,
          "DefaultLinkPermission": 1,
          "RequireAnonymousLinksExpireInDays": 30,
          "SharingDomainRestrictionMode": "AllowList",
          "SharingAllowedDomainList": "partner.com vendor.com"
        }
      },
      "verifyAttempts": [],
      "perControl": {},
      "error": "SPO bulk apply failed: Set-SPOTenant bulk update failed",
      "desiredByControl": {
        "SharePointPreventExternalUsersFromResharingEnabled": {
          "PreventExternalUsersFromResharing": true
        },
        "SharePointDefaultLinkTypeRestricted": {
          "DefaultSharingLinkType": 2
        },
        "SharePointDefaultSharingRestricted": {
          "DefaultLinkPermission": 1
        },
        "SharePointLinkExpirationConfigured": {
          "RequireAnonymousLinksExpireInDays": 30
        },
        "SharePointDomainRestrictionConfigured": {
          "SharingDomainRestrictionMode": "AllowList"
        },
        "SharePointSharingAllowedDomainListConfigured": {
          "SharingDomainRestrictionMode": "AllowList",
          "SharingAllowedDomainList": "partner.com vendor.com"
        }
      },
      "missingDesiredConfigByControl": {
        "SharePointIdleSessionTimeout": [
          "UNSUPPORTED: Set-SPOTenant does not support IdleSessionSignOut* parameters"
        ]
      }
    },
    "reasonCode": "MISSING_SIGNAL",
    "reasonDetail": "SPO bulk apply failed: Set-SPOTenant bulk update failed"
  },
  "status": 424,
  "durationSeconds": 0.0
}